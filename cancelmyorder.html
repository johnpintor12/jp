<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Cancellation Request Workflow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/global_styles.css">
    <style>
        /* Theme-specific styles for Order Cancellation Request Workflow (Emerald/Green Theme) */
        /* body.has-toc is handled by global_styles.css for responsive layout */

        #toc-sidebar h2 {
            color: #059669; /* Emerald/Green */
        }
        #toc-sidebar li a:hover,
        #toc-sidebar li a.active { 
            background-color: #d1fae5; /* Light Emerald */
            color: #059669; /* Emerald */
        }
        /* No sub-levels in this TOC, but if added:
         #toc-sidebar ul ul li a:hover,
         #toc-sidebar ul ul li a.active { 
             color: #059669; 
             background-color: #a7f3d0; 
        } */

        .step-header { /* Main step header color for this page */
            background-color: #059669; /* Emerald/Green */
        }
        /* Specific card header colors */
        .escalation-card .step-header { 
             background-color: #8b5cf6 !important; /* Violet for escalations, ensure it overrides global */
        }
        
        #scrollToTopBtn {
            background-color: #059669; /* Emerald/Green */
        }
        #scrollToTopBtn:hover {
            background-color: #047857; /* Darker Emerald/Green */
        }

        /* Print-specific overrides for themed elements */
        @media print {
            .step-header { 
                background-color: #d1fae5 !important; /* Lighter Emerald for print */
                color: #047857 !important; 
            }
            .escalation-card .step-header { 
                background-color: #ddd6fe !important; /* Keep violet for escalation */
                color: #4c1d95 !important;
            }
            #toc-sidebar h2 {
                color: #059669 !important; 
            }
        }
    </style>
</head>
<body class="has-toc"> 

    <button id="menu-toggle" aria-label="Open navigation menu">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
    </button>
    <div id="page-overlay"></div>

    <nav id="toc-sidebar">
        <h2>Workflow Navigation</h2>
        <ul>
            <li>
                <a href="index.html" class="back-link">
                    <svg class="inline-block mr-1 -ml-1 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" style="vertical-align: text-bottom;">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                    Back to Library
                </a>
            </li>
            <li><a href="#context">Context</a></li>
            <li><a href="#step1">Step 1: Determine Order</a></li>
            <li><a href="#step2">Step 2: Identify Cancel Reason</a></li>
            <li><a href="#step3">Step 3: Escalate to Agent</a></li>
        </ul>
    </nav>

    <div class="main-content-area toc-active">
        <header class="text-center mb-10">
            <h1 class="text-3xl font-bold text-gray-800">Order Cancellation Request Workflow</h1>
            <p class="text-lg text-gray-600">Visualized Logic for Handling Customer Cancellation Requests</p>
        </header>

        <div class="max-w-4xl mx-auto">

            <div id="context" class="content-section flow-element">
                <h2>Context</h2>
                <p>Customers will reach out to request for order cancellation. Your job is to look up their order details and assist them by providing information. If the order has been fulfilled, ask question why they want to cancel it.</p>
            </div>

            <div class="connector">▼</div>

            <div id="step1" class="step-card flow-element">
                <div class="step-header">
                    <h3>Step 1: Determine the order that the customer is referring to</h3>
                </div>
                <div class="step-content">
                    <div class="scenario-card">
                        <h4>Order Identification Methods:</h4>
                        <ul class="list-disc pl-5 mt-1 space-y-2">
                            <li>
                                <strong>Customer provides an order number:</strong>
                                <ul class="list-disc pl-5">
                                    <li>This is the order they are referring to.</li>
                                    <li>If that order does not exist, ask the customer for the email address associated with the order.</li>
                                </ul>
                            </li>
                            <li>
                                <strong>No orders associated with a provided customer email address:</strong>
                                <ul class="list-disc pl-5">
                                    <li>Ask them for the correct email address associated with their order.</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Customer forwards the order confirmation email while requesting cancellation:</strong>
                                <ul class="list-disc pl-5">
                                    <li>Try to examine the email content for the order number.</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="connector">▼</div>

            <div id="step2" class="step-card flow-element">
                <div class="step-header">
                    <h3>Step 2: Identify the reason for cancel</h3>
                </div>
                <div class="step-content">
                    <p class="mb-2">Note: The context mentions asking for the reason "If the order has been fulfilled." This step should ideally be triggered after confirming fulfillment status (which isn't explicitly detailed before this step in the provided instructions, but is implied by the context).</p>
                    <div class="condition-card"> 
                        <h4>Handling Customer Reasons:</h4>
                        <ul class="list-disc pl-5 mt-1 space-y-2">
                            <li>
                                <strong>If the customer provides no reason:</strong>
                                <ul class="list-disc pl-5">
                                    <li>Ask the customer for the reason for the cancellation. (Especially if order is fulfilled)</li>
                                </ul>
                            </li>
                            <li>
                                <strong>If the customer provides a reason "waiting too long for order":</strong>
                                <ul class="list-disc pl-5">
                                    <li>Apologize to the customer for the delay.</li>
                                </ul>
                            </li>
                            <li>
                                <strong>If the customer provides a reason "I found cheaper":</strong>
                                <ul class="list-disc pl-5">
                                    <li>Apologize to the customer. (Maintain helpful tone, avoid defensiveness).</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="connector">▼</div>

            <div id="step3" class="step-card escalation-card flow-element">
                <div class="step-header"> 
                    <h3>Step 3: Get order information and escalate to an agent</h3>
                </div>
                <div class="step-content">
                    <div class="action-card">
                        <h4>Actions:</h4>
                        <ul class="list-disc pl-5 mt-1">
                            <li>Retrieve and confirm all relevant details for the identified order.</li>
                            <li>Based on the instructions, the next step is to escalate. (Further details on *how* to escalate, what information to pass, or specific agent assignment were not provided in this workflow's instructions but would typically be defined).</li>
                            <li>Inform the customer: "Thank you for that information. I will now pass your cancellation request and order details to our support team who will review it and get back to you shortly." <span class="badge badge-purple">ESCALATE TO AGENT</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button onclick="scrollToTop()" id="scrollToTopBtn" title="Go to top">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
            <path fill-rule="evenodd" d="M10 17a.75.75 0 01-.75-.75V5.56l-2.47 2.47a.75.75 0 01-1.06-1.06l3.75-3.75a.75.75 0 011.06 0l3.75 3.75a.75.75 0 11-1.06 1.06L10.75 5.56v10.69A.75.75 0 0110 17z" clip-rule="evenodd" />
        </svg>
    </button>

    <script>
        // Scroll-to-top button functionality
        var scrollToTopButton = document.getElementById("scrollToTopBtn");
        window.onscroll = function() {scrollFunction()};
        function scrollFunction() {
            if (scrollToTopButton) {
                if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                    scrollToTopButton.style.display = "block";
                } else {
                    scrollToTopButton.style.display = "none";
                }
            }
        }
        function scrollToTop() {
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        // TOC and Hamburger Menu Functionality
        const tocSidebar = document.getElementById('toc-sidebar');
        const menuToggle = document.getElementById('menu-toggle');
        const pageOverlay = document.getElementById('page-overlay');
        
        if (menuToggle && tocSidebar) {
            menuToggle.addEventListener('click', () => {
                tocSidebar.classList.toggle('open');
                menuToggle.classList.toggle('shifted'); 
                if (pageOverlay) pageOverlay.classList.toggle('active'); 
            });
        }
        if (pageOverlay) {
            pageOverlay.addEventListener('click', () => { 
                tocSidebar.classList.remove('open');
                menuToggle.classList.remove('shifted');
                pageOverlay.classList.remove('active');
            });
        }
        
        document.querySelectorAll('#toc-sidebar a:not(.back-link)').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const targetId = this.getAttribute('href');
                if (targetId && targetId.startsWith('#')) {
                    e.preventDefault();
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        if (window.innerWidth < 1024 && tocSidebar.classList.contains('open')) { 
                            tocSidebar.classList.remove('open');
                            menuToggle.classList.remove('shifted');
                            if (pageOverlay) pageOverlay.classList.remove('active');
                        }
                        document.querySelectorAll('#toc-sidebar a').forEach(link => link.classList.remove('active'));
                        this.classList.add('active');
                    }
                }
            });
        });

        const sections = document.querySelectorAll('.content-section[id], .step-card[id]'); 
        const tocLinksJS = document.querySelectorAll('#toc-sidebar a:not(.back-link)');

        const makeActive = (linkId) => {
            tocLinksJS.forEach(l => l.classList.remove('active'));
            if (linkId) {
                const correspondingLink = document.querySelector(`#toc-sidebar a[href="#${linkId}"]`);
                if (correspondingLink) {
                    correspondingLink.classList.add('active');
                     const parentLi = correspondingLink.closest('ul')?.closest('li');
                    if (parentLi) {
                        const parentAnchor = parentLi.querySelector('a');
                        if(parentAnchor && !parentAnchor.classList.contains('back-link') && parentAnchor.getAttribute('href').startsWith('#step')) { 
                           parentAnchor.classList.add('active');
                        }
                    }
                }
            }
        };
        
        const observer = new IntersectionObserver(entries => {
            let intersectingEntry = null;
            for (let i = 0; i < entries.length; i++) { 
                 if (entries[i].isIntersecting) {
                    if (!intersectingEntry || entries[i].target.getBoundingClientRect().top < intersectingEntry.target.getBoundingClientRect().top) {
                        if (entries[i].intersectionRatio >= 0.1) { 
                           intersectingEntry = entries[i];
                        }
                    }
                 }
            }
            if (intersectingEntry) {
                 makeActive(intersectingEntry.target.id);
            }
        }, { threshold: [0.1, 0.5], rootMargin: "-40% 0px -50% 0px" });

        sections.forEach(section => { if (section.id) { observer.observe(section); } });
    </script>

</body>
</html>
