<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Cancellation Request Workflow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
            display: flex; 
        }
        /* Table of Contents Sidebar */
        #toc-sidebar {
            width: 280px; 
            position: fixed; 
            left: 0;
            top: 0;
            height: 100vh; 
            background-color: #ffffff; 
            border-right: 1px solid #e5e7eb; 
            padding: 2rem 1.5rem;
            overflow-y: auto; 
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
        }
        #toc-sidebar h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #059669; /* Emerald/Green to match step headers */
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        #toc-sidebar ul {
            list-style: none;
            padding: 0;
        }
        #toc-sidebar li a {
            display: block;
            padding: 0.5rem 0;
            color: #374151; 
            text-decoration: none;
            font-size: 0.9rem;
            border-radius: 4px;
            transition: background-color 0.2s ease, color 0.2s ease;
            padding-left: 0.5rem;
        }
        #toc-sidebar li a:hover,
        #toc-sidebar li a.active { 
            background-color: #d1fae5; /* Light Emerald */
            color: #059669; /* Emerald */
            font-weight: 500;
        }
        #toc-sidebar li a.back-link {
            color: #6366f1; /* Indigo for consistency with other back buttons */
            font-weight: 500;
            margin-bottom: 1rem; 
            border-bottom: 1px solid #e5e7eb; 
            padding-bottom: 0.75rem;
        }
        #toc-sidebar li a.back-link:hover {
            color: #4338ca; 
            background-color: transparent; 
        }

        /* Main Content Area */
        .main-content-area {
            margin-left: 280px; 
            flex-grow: 1; 
            padding: 1.5rem; 
        }
        .content-section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 1.5rem;
            padding: 1.5rem;
        }
        .content-section h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937; 
            margin-bottom: 1rem;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.5rem;
        }
        .step-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 1.5rem;
            overflow: hidden;
            scroll-margin-top: 20px; 
        }
        .step-header {
            background-color: #059669; /* Emerald/Green for this workflow */
            color: white;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        .step-header h3 {
            font-size: 1.25rem;
            font-weight: 600;
        }
        .step-content {
            padding: 1.5rem;
        }
        .scenario-card, .action-card, .condition-card, .escalation-card {
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 1rem;
            background-color: #f9fafb;
        }
        .scenario-card h4, .action-card h4, .condition-card h4, .escalation-card h4 {
            font-size: 1rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        .escalation-card { 
            border-left: 4px solid #8b5cf6; 
            background-color: #f5f3ff;
        }
        .connector {
            text-align: center;
            margin: 1rem 0;
            font-size: 1.5rem;
            color: #9ca3af;
        }
        ul { /* General ul styling */
            list-style-type: disc;
            padding-left: 1.5rem;
        }
        li {
            margin-bottom: 0.5rem;
        }
        .badge { 
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-left: 0.5rem;
        }
        .badge-red { background-color: #fee2e2; color: #991b1b; }
        .badge-yellow { background-color: #fef3c7; color: #92400e; }
        .badge-purple { background-color: #ede9fe; color: #5b21b6; }

        .flow-element {
            position: relative;
            margin-bottom: 20px;
        }
        .flow-element:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -20px;
            transform: translateX(-50%);
            width: 2px;
            height: 20px;
            background-color: #cbd5e1;
            z-index: -1;
        }
        #scrollToTopBtn {
            display: none; 
            position: fixed; 
            bottom: 30px; 
            right: 30px; 
            z-index: 99; 
            border: none; 
            outline: none; 
            background-color: #059669; /* Emerald/Green to match step header */
            color: white; 
            cursor: pointer; 
            padding: 12px 15px; 
            border-radius: 50%; 
            font-size: 18px; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: background-color 0.3s ease, opacity 0.3s ease, visibility 0.3s ease;
        }
        #scrollToTopBtn:hover {
            background-color: #047857; /* Darker Emerald/Green */
        }
         @media print { 
            body { background-color: white; font-size: 10pt; padding: 0.5in; display: block; }
            #toc-sidebar { display: none !important; } 
            .main-content-area { margin-left: 0 !important; padding: 0 !important; } 
            .content-section, .step-card, .scenario-card, .action-card, .condition-card, .escalation-card {
                box-shadow: none; border: 1px solid #ccc; page-break-inside: avoid;
            }
            .step-header { background-color: #d1fae5 !important; color: #047857 !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .escalation-card .step-header { background-color: #ddd6fe !important; color: #4c1d95 !important;}
            .badge { -webkit-print-color-adjust: exact; print-color-adjust: exact; border: 1px solid #ccc; }
            .badge-purple { background-color: #ede9fe !important; color: #5b21b6 !important; }
            .connector, .flow-element::after, #scrollToTopBtn { display: none !important; }
            header h1 { font-size: 18pt; }
            header p { font-size: 12pt; }
            .content-section h2 { font-size: 14pt; }
            .step-header h3 { font-size: 12pt; }
            .scenario-card h4, .action-card h4, .condition-card h4, .escalation-card h4 { font-size: 10pt; }
            li, p { font-size: 9pt; }
            .badge { font-size: 8pt; }
        }
    </style>
</head>
<body>

    <nav id="toc-sidebar">
        <h2>Workflow Navigation</h2>
        <ul>
            <li>
                <a href="index.html" class="back-link">
                    <svg class="inline-block mr-1 -ml-1 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" style="vertical-align: text-bottom;">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                    Back to Library
                </a>
            </li>
            <li><a href="#context">Context</a></li>
            <li><a href="#step1">Step 1: Determine Order</a></li>
            <li><a href="#step2">Step 2: Identify Cancel Reason</a></li>
            <li><a href="#step3">Step 3: Escalate to Agent</a></li>
        </ul>
    </nav>

    <div class="main-content-area">
        <header class="text-center mb-10">
            <h1 class="text-3xl font-bold text-gray-800">Order Cancellation Request Workflow</h1>
            <p class="text-lg text-gray-600">Visualized Logic for Handling Customer Cancellation Requests</p>
        </header>

        <div class="max-w-4xl mx-auto">

            <div id="context" class="content-section flow-element">
                <h2>Context</h2>
                <p>Customers will reach out to request for order cancellation. Your job is to look up their order details and assist them by providing information. If the order has been fulfilled, ask question why they want to cancel it.</p>
            </div>

            <div class="connector">▼</div>

            <div id="step1" class="step-card flow-element">
                <div class="step-header">
                    <h3>Step 1: Determine the order that the customer is referring to</h3>
                </div>
                <div class="step-content">
                    <div class="scenario-card">
                        <h4>Order Identification Methods:</h4>
                        <ul class="list-disc pl-5 mt-1 space-y-2">
                            <li>
                                <strong>Customer provides an order number:</strong>
                                <ul class="list-disc pl-5">
                                    <li>This is the order they are referring to.</li>
                                    <li>If that order does not exist, ask the customer for the email address associated with the order.</li>
                                </ul>
                            </li>
                            <li>
                                <strong>No orders associated with a provided customer email address:</strong>
                                <ul class="list-disc pl-5">
                                    <li>Ask them for the correct email address associated with their order.</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Customer forwards the order confirmation email while requesting cancellation:</strong>
                                <ul class="list-disc pl-5">
                                    <li>Try to examine the email content for the order number.</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="connector">▼</div>

            <div id="step2" class="step-card flow-element">
                <div class="step-header">
                    <h3>Step 2: Identify the reason for cancel</h3>
                </div>
                <div class="step-content">
                    <p class="mb-2">Note: The context mentions asking for the reason "If the order has been fulfilled." This step should ideally be triggered after confirming fulfillment status (which isn't explicitly detailed before this step in the provided instructions, but is implied by the context).</p>
                    <div class="condition-card"> <h4>Handling Customer Reasons:</h4>
                        <ul class="list-disc pl-5 mt-1 space-y-2">
                            <li>
                                <strong>If the customer provides no reason:</strong>
                                <ul class="list-disc pl-5">
                                    <li>Ask the customer for the reason for the cancellation. (Especially if order is fulfilled)</li>
                                </ul>
                            </li>
                            <li>
                                <strong>If the customer provides a reason "waiting too long for order":</strong>
                                <ul class="list-disc pl-5">
                                    <li>Apologize to the customer for the delay.</li>
                                </ul>
                            </li>
                            <li>
                                <strong>If the customer provides a reason "I found cheaper":</strong>
                                <ul class="list-disc pl-5">
                                    <li>Apologize to the customer. (Maintain helpful tone, avoid defensiveness).</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="connector">▼</div>

            <div id="step3" class="step-card escalation-card flow-element">
                <div class="step-header !bg-purple-600">
                    <h3>Step 3: Get order information and escalate to an agent</h3>
                </div>
                <div class="step-content">
                    <div class="action-card">
                        <h4>Actions:</h4>
                        <ul class="list-disc pl-5 mt-1">
                            <li>Retrieve and confirm all relevant details for the identified order.</li>
                            <li>Based on the instructions, the next step is to escalate. (Further details on *how* to escalate, what information to pass, or specific agent assignment were not provided in this workflow's instructions but would typically be defined).</li>
                            <li>Inform the customer: "Thank you for that information. I will now pass your cancellation request and order details to our support team who will review it and get back to you shortly." <span class="badge badge-purple">ESCALATE TO AGENT</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button onclick="scrollToTop()" id="scrollToTopBtn" title="Go to top">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
            <path fill-rule="evenodd" d="M10 17a.75.75 0 01-.75-.75V5.56l-2.47 2.47a.75.75 0 01-1.06-1.06l3.75-3.75a.75.75 0 011.06 0l3.75 3.75a.75.75 0 11-1.06 1.06L10.75 5.56v10.69A.75.75 0 0110 17z" clip-rule="evenodd" />
        </svg>
    </button>

    <script>
        // Scroll-to-top button functionality
        var scrollToTopButton = document.getElementById("scrollToTopBtn");
        window.onscroll = function() {scrollFunction()};
        function scrollFunction() {
            if (scrollToTopButton) {
                if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                    scrollToTopButton.style.display = "block";
                } else {
                    scrollToTopButton.style.display = "none";
                }
            }
        }
        function scrollToTop() {
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        // TOC smooth scrolling and active state
        document.querySelectorAll('#toc-sidebar a:not(.back-link)').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    document.querySelectorAll('#toc-sidebar a').forEach(link => link.classList.remove('active'));
                    this.classList.add('active');
                }
            });
        });

        const sections = document.querySelectorAll('.content-section[id], .step-card[id]');
        const tocLinks = document.querySelectorAll('#toc-sidebar a:not(.back-link)');

        const makeActive = (linkId) => {
            tocLinks.forEach(l => l.classList.remove('active'));
            if (linkId) {
                const correspondingLink = document.querySelector(`#toc-sidebar a[href="#${linkId}"]`);
                if (correspondingLink) {
                    correspondingLink.classList.add('active');
                }
            }
        };

        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting && entry.intersectionRatio >= 0.5) {
                    makeActive(entry.target.id);
                }
            });
        }, {
            threshold: 0.5,
            rootMargin: "-50px 0px -50% 0px" 
        });

        sections.forEach(section => {
            if (section.id) {
                 observer.observe(section);
            }
        });
    </script>

</body>
</html>
